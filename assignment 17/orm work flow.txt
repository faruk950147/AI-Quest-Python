ORM Proper Notes (Django Focused)

1Ô∏è‚É£ **ORM ‡¶ï‡ßÄ?**

* ORM = Object-Relational Mapping
* Database table ‡¶ï‡ßá Python class ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá map ‡¶ï‡¶∞‡ßá
* SQL ‡¶®‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßá database query ‡¶ì manipulation ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨
* Python objects ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá CRUD ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü

**Example:**

```python
from django.db import models

class Product(models.Model):
    name = models.CharField(max_length=100)
    price = models.FloatField()
```

2Ô∏è‚É£ **ORM Workflow Steps**

**Step 1: Model Definition**

* Class define ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ table represent ‡¶ï‡¶∞‡ßá
* Fields = columns

```python
class Category(models.Model):
    title = models.CharField(max_length=50)
```

**Step 2: Migrations**

* Database update ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø migrations ‡¶§‡ßà‡¶∞‡¶ø ‡¶ì apply ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü

```bash
python manage.py makemigrations
python manage.py migrate
```

**Step 3: Manager**

* ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø model ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá Manager ‡¶•‡¶æ‡¶ï‡ßá (`objects`)
* Query execution ‡¶ì object retrieval handle ‡¶ï‡¶∞‡ßá

```python
# Retrieve all products
Product.objects.all()

# Filter products with price > 100
Product.objects.filter(price__gt=100)
```

* **Custom Manager Example:**

```python
class ProductManager(models.Manager):
    def expensive_products(self):
        return self.filter(price__gt=500)

class Product(models.Model):
    name = models.CharField(max_length=100)
    price = models.FloatField()
    objects = ProductManager()
```

**Usage:**

```python
expensive = Product.objects.expensive_products()
```

**Step 4: ORM Query Execution**

* Python code ‚Üí ORM ‚Üí SQL ‚Üí Database ‚Üí Python objects returned

**Example:**

```python
expensive_products = Product.objects.expensive_products()
```

**Generated SQL:**

```sql
SELECT * FROM product WHERE price > 500;
```

**Step 5: Object Manipulation (CRUD)**

```python
# Create
p = Product(name="Laptop", price=1200)
p.save()

# Update
p.price = 1300
p.save()

# Delete
p.delete()
```

**Step 6: Relationships**

* ORM supports relationships: ForeignKey, ManyToManyField, OneToOneField

```python
class Category(models.Model):
    title = models.CharField(max_length=50)

class Product(models.Model):
    name = models.CharField(max_length=100)
    category = models.ForeignKey(Category, on_delete=models.CASCADE)
```

**Query related objects:**

```python
cat = Category.objects.get(id=1)
cat_products = cat.product_set.all()
```

3Ô∏è‚É£ **ORM Workflow Diagram (Conceptual)**

```
Python Code (Model & Query)
        ‚îÇ
        ‚ñº
ORM Manager (objects)
        ‚îÇ
        ‚ñº
SQL Query Generated
        ‚îÇ
        ‚ñº
Database (CRUD operation)
        ‚îÇ
        ‚ñº
Python Objects Returned
```

4Ô∏è‚É£ **Key Points**

* ORM = Python ‚Üî Database Bridge
* Manager = Gateway for queries
* Objects = Table rows as Python instances
* Workflow = Define Model ‚Üí Migration ‚Üí Query ‚Üí Manipulate ‚Üí Save
* ORM workflow = Pythonic way to handle database

üí° **Extra Tips**

* ORM knowledge = essential for Django developers
* Understanding migrations = crucial
* Custom managers = reusable query logic
* Relationships = powerful feature for complex data
